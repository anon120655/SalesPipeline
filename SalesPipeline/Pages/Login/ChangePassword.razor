@page "/changepassword"

@layout MainLayoutBlank

@if (isAuthorize == true)
{
	<section class="h-100 gradient-form" style="background-color: #e5eef6;">
		<div class="container py-5 h-100">
			<div class="row d-flex justify-content-center align-items-center h-100">
				<div class="col-xl-5">
					<div class="card rounded-3">
						<div class="row g-0">
							<div class="col-lg-12">
								<div class="card-body p-md-5 mx-md-4">
									@if (isSuccess)
									{
										<div class="text-center fw-bold">
											<NavLink href="/">
												<img src="/image/icon/success_b.png" width="50" />
											</NavLink>
											<div class="form-outline my-5 text-center">
												<h2>Success!</h2>
											</div>
											<div class="text-center pt-1 pb-1">
												<button @onclick=GoToLogin type="button" class="btn btn-outline-secondary w-100">Go to login</button>
											</div>
										</div>
									}
									else
									{
										<div class="text-center fw-bold">
											<NavLink href="/">
												<img src="/image/icon/key_lock.png" width="30" />
											</NavLink>
											<h4 class="mt-5 pb-3">Change Password</h4>
											<EditForm Model="@changeModel" OnValidSubmit="SubmitChange" class="bg-white p-2" autocomplete="off">
												<DataAnnotationsValidator />
												<div class="form-outline mb-4 text-start">
													<label class="form-label text-muted">Old Password</label>
													<input type="password" @bind="@changeModel.OldPassword" class="form-control" autocomplete="new-password" />
													<ValidationMessage For="@(() => changeModel.OldPassword)" />
												</div>
												<div class="form-outline mb-4 text-start">
													<label class="form-label text-muted">New Password</label>
													<input type="password" @bind="@changeModel.NewPassword" class="form-control" autocomplete="new-password" />
													<ValidationMessage For="@(() => changeModel.NewPassword)" />
												</div>
												<div class="form-outline mb-4 text-start">
													<label class="form-label text-muted">Confirm Password</label>
													<input type="password" @bind="@changeModel.ConfirmPassword" class="form-control" autocomplete="new-password" />
													<ValidationMessage For="@(() => changeModel.ConfirmPassword)" />
												</div>
												<div class="text-center pt-1 mb-5 pb-1">
													<Button Color="ButtonColor.Info"
															Type="ButtonType.Submit"
															Disabled="@isLoading" Class="btn-block fa-lg gradient-custom-2 mb-3 w-100 text-white">
														@if (isLoading)
														{
															<Spinner Color="SpinnerColor.Light" Size="SpinnerSize.Small" />
														}
														Change Password
													</Button>
												</div>
												@if (_errorMessage is not null)
												{
													<div class="alert alert-danger alert-dismissible" role="alert">
														<p class="text-red">@_errorMessage</p>
													</div>
												}
											</EditForm>
										</div>
									}
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
}


